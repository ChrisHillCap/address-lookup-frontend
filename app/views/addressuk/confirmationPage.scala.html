@*
* Copyright 2016 HM Revenue & Customs
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*@
@(tag: String,
        view: address.ViewConfig,
        normativeAddress: Option[uk.gov.hmrc.address.v2.AddressRecord],
        userSuppliedAddress: Option[uk.gov.hmrc.address.v2.Address],
        international: Option[uk.gov.hmrc.address.v2.International])(implicit request: Request[_], messages: Messages)

@main_template(view = view, bodyClasses = Some("confirmation-page")) {

    <style type="text/css">
    #confirmation th.head { padding: .5em; }
    #confirmation td { background: #fff; padding: .5em; }
    #confirmation td.empty { background: #eee; }
    </style>
    <div class="govuk-box-highlight">
        <h2 class="bold-large">Application complete</h2>
        <p>Address:</p>
        <table id="confirmation">
            <tr><th></th> <th class="head">Normative</th> <th class="head">User-Supplied</th> <th class="head">International</th></tr>

            @if(normativeAddress.isDefined) {
                <tr class="uprn"><th>UPRN</th>
                    <td class="norm">@{normativeAddress.get.uprn}</td>
                    <td class="empty"></td>
                    <td class="empty"></td>
                </tr>
            }

            <tr class="addr"><th>Address</th>
                @cellIfList(normativeAddress.isDefined, normativeAddress.get.address.lines, "norm")
                @cellIfList(userSuppliedAddress.isDefined, userSuppliedAddress.get.lines, "user")
                @cellIfList(international.isDefined, international.get.lines, "int")
            </tr>

            @if(normativeAddress.flatMap(_.address.town).isDefined || userSuppliedAddress.flatMap(_.town).isDefined) {
                <tr class="town"><th>Town</th>
                    @cellIfOpt(normativeAddress.isDefined, normativeAddress.get.address.town, "norm")
                    @cellIfOpt(userSuppliedAddress.isDefined, userSuppliedAddress.get.town, "user")
                    <td class="empty"></td>
                </tr>
            }

            @if(normativeAddress.flatMap(_.address.county).isDefined || userSuppliedAddress.flatMap(_.county).isDefined) {
                <tr class="county"><th>County</th>
                    @cellIfOpt(normativeAddress.isDefined, normativeAddress.get.address.county, "norm")
                    @cellIfOpt(userSuppliedAddress.isDefined && userSuppliedAddress.flatMap(_.county) != normativeAddress.flatMap(_.address.county), userSuppliedAddress.get.county, "user")
                    <td class="empty"></td>
                </tr>
            }

            @if(normativeAddress.isDefined || userSuppliedAddress.isDefined || international.flatMap(_.postcode).isDefined) {
                <tr class="postcode"><th>Postcode</th>
                    @cellIf(normativeAddress.isDefined, normativeAddress.get.address.postcode, "norm")
                    @cellIfDifferent(userSuppliedAddress.map(_.postcode), normativeAddress.map(_.address.postcode), "user")
                    @cellIfOpt(international.isDefined, international.get.postcode, "int")
                </tr>
            }

            @if(normativeAddress.isDefined || userSuppliedAddress.isDefined) {
                <tr class="subd"><th></th>
                    @cellIfOpt(normativeAddress.isDefined, normativeAddress.get.address.subdivision.map(_.name), "norm")
                    @cellIfDifferent(userSuppliedAddress.flatMap(_.subdivision), normativeAddress.flatMap(_.address.subdivision), "user")
                    <td class="empty"></td>
                </tr>
            }

            <tr class="country"><th>Country</th>
                @cellIf(normativeAddress.isDefined, normativeAddress.get.address.country.code, "norm")
                @cellIfDifferent(userSuppliedAddress.map(_.country.name), normativeAddress.map(_.address.country.name), "user")
                @cellIfOpt(international.isDefined, international.get.country.map(_.name), "int")
            </tr>

            @if(normativeAddress.isDefined) {
                <tr class="lang"><th>Language</th>
                    <td class="norm">@{normativeAddress.get.language}</td>
                    <td class="empty"></td>
                    <td class="empty"></td>
                </tr>
            }
        </table>
        <a href="../@{
            tag
        }">Start again</a>
    </div>

}

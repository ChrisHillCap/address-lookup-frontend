@*
* Copyright 2016 HM Revenue & Customs
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*     http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*@
@import address.ViewConfig
@(tag: String,
  view: ViewConfig,
  addressForm: Form[address.uk.UkAddressData],
  noMatchesWereFound: Boolean,
  exceededLimit: Boolean)(implicit request: Request[_], messages: Messages)

@import uk.gov.hmrc.play.views.html.helpers

@main_template(view = view, bodyClasses = Some("entry-form")) {

<script type="text/javascript">
function showIntTab() {
    window.location.href = '@address.international.routes.IntAddressLookupController.getEmptyForm(tag, addressForm("guid").value, addressForm("continue-url").value, addressForm("back-url").value, addressForm("back-text").value).url';
}
function showBfpoTab() {
    window.location.href = '@address.bfpo.routes.BfpoAddressLookupController.getEmptyForm(tag, addressForm("guid").value, addressForm("continue-url").value, addressForm("back-url").value, addressForm("back-text").value).url';
}
</script>
<div>
    <h1 class="heading-xlarge">@{view.baseTitle}</h1>

    <legend class="visuallyhidden">@{view.prompt}</legend>

    <label class="form-label-bold" for="location">@{view.prompt}</label>
    <fieldset class="inline">
        @if(view.allowInternationalAddress) {
            <div class="form-group" id="location">
                <label class="block-label" data-target="UK-Tab" for="location-UK">
                    <input id="location-UK" type="radio" name="radio-inline-group" value="UK" checked="checked" />
                    United Kingdom
                </label>

                <label class="block-label" data-target="INT-Tab" for="location-international">
                    <input id="location-international" type="radio" name="radio-inline-group" value="INT" onclick="showIntTab()"/>
                    International
                </label>

                <label class="block-label" data-target="BFPO-Tab" for="location-BFPO">
                    <input id="location-BFPO" type="radio" name="radio-inline-group" value="BFPO" onclick="showBfpoTab()"/>
                    BFPO
                </label>
            </div>
        }

        <div class="panel panel-border-narrow" id='UK-Tab'>
        @helpers.form( address.uk.routes.UkAddressLookupController.postFirstForm(tag), 'id -> "myForm" ) {
            <input type='hidden' id='guid' name='guid' value='@addressForm("guid").value.get' />
            <input type='hidden' id='continue-url' name='continue-url' value='@addressForm("continue-url").value.get' />
            <input type='hidden' id='back-url' name='back-url' value='@addressForm("back-url").value.getOrElse("")' />
            <input type='hidden' id='back-text' name='back-text' value='@addressForm("back-text").value.getOrElse("")' />
            <input type='hidden' id='country-code' name='country-code' value='@addressForm("country-code").value.get' />

            @if(!noMatchesWereFound && view.allowNoFixedAddress) {
            <div class="form-group">
                <label class="form-checkbox" for="no-fixed-address">
                    <input id="no-fixed-address" name="no-fixed-address" type="checkbox" value="true">
                    I have no fixed address
                </label>
            </div>
            }

            <div class="form-group">
                @helper.inputText(addressForm("house-name-number"), 'class -> "form-control", '_label -> "Building name or number" )
            </div>


            <div class="form-group">
                @helper.inputText(addressForm("postcode"), 'class -> "form-control", '_label -> "Post code", 'maxlength -> "8"  )
            </div>

            @if(noMatchesWereFound) {
                <div class="form-group">
                    <div class="warning-box">
                        @if(addressForm("house-name-number").value.isDefined) {
                            <h3>No addresses were found for this postcode and building name/number.</h3>
                            <p>Please enter a different postcode or building name/number.</p>
                        } else {
                            <h3>No addresses were found for this postcode.</h3>
                            <p>Please enter a different postcode.</p>
                        }
                    </div>
                </div>
            }

            @if(exceededLimit) {
                <div class="form-group">
                    <div class="warning-box">
                        <h3>More than @view.maxAddressesToShow addresses were found.</h3>
                        <p>Please enter the first line of your address.</p>
                    </div>
                </div>
            }

            <div class="form-group">
                <button type="submit" name="submit" value="continue">Continue</button>
            </div>

            <div class="grid-wrapper nav">
                @if(addressForm("back-url").value.isDefined) {
                    <a class="page-nav__link page-nav__link--previous"
                    title="Navigate to previous page)" rel="prev" href="@(addressForm("back-url").value.get)">
                        <span class="page-nav__label">Previous</span>
                        <span class="page-nav__title">@addressForm("back-text").value.get</span>
                    </a>

                }
            </div>
        }
        </div>
    </fieldset>

</div>
}
